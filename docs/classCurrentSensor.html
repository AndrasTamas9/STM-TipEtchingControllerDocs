<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>STM Tip Etching Controller: CurrentSensor Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">STM Tip Etching Controller
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classCurrentSensor-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">CurrentSensor Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Non-blocking RMS current measurement helper class.  
 <a href="classCurrentSensor.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="CurrentSensor_8h_source.html">CurrentSensor.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:abefb5c33798e3e1c1dfc01c833512021" id="r_abefb5c33798e3e1c1dfc01c833512021"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#abefb5c33798e3e1c1dfc01c833512021">CurrentSensor</a> (uint8_t analogPin, float Vref=5.0f, float adcMax=1023.0f, float k_cal=0.90f, unsigned long sampleWindow_us=20000UL, unsigned long sampleInterval_us=200UL)</td></tr>
<tr class="memdesc:abefb5c33798e3e1c1dfc01c833512021"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a new <a class="el" href="classCurrentSensor.html" title="Non-blocking RMS current measurement helper class.">CurrentSensor</a> object with configuration parameters.  <br /></td></tr>
<tr class="separator:abefb5c33798e3e1c1dfc01c833512021"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d8b040f89d8ea8a38ab4dfc25967a54" id="r_a9d8b040f89d8ea8a38ab4dfc25967a54"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#a9d8b040f89d8ea8a38ab4dfc25967a54">begin</a> ()</td></tr>
<tr class="memdesc:a9d8b040f89d8ea8a38ab4dfc25967a54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the sensor and reset internal statistics.  <br /></td></tr>
<tr class="separator:a9d8b040f89d8ea8a38ab4dfc25967a54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa56cbbf919273ecad1ff8a158b92ec5" id="r_aaa56cbbf919273ecad1ff8a158b92ec5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#aaa56cbbf919273ecad1ff8a158b92ec5">update</a> ()</td></tr>
<tr class="memdesc:aaa56cbbf919273ecad1ff8a158b92ec5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform one non-blocking update step of the measurement.  <br /></td></tr>
<tr class="separator:aaa56cbbf919273ecad1ff8a158b92ec5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5c066aa3ebd36107f9b94fb17a00ae1" id="r_aa5c066aa3ebd36107f9b94fb17a00ae1"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#aa5c066aa3ebd36107f9b94fb17a00ae1">lastVpp</a> () const</td></tr>
<tr class="memdesc:aa5c066aa3ebd36107f9b94fb17a00ae1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the last computed peak-to-peak voltage.  <br /></td></tr>
<tr class="separator:aa5c066aa3ebd36107f9b94fb17a00ae1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1cf6c33a21ba788b1801f89e10e88dd" id="r_ab1cf6c33a21ba788b1801f89e10e88dd"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#ab1cf6c33a21ba788b1801f89e10e88dd">lastIrms</a> () const</td></tr>
<tr class="memdesc:ab1cf6c33a21ba788b1801f89e10e88dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the last computed RMS current.  <br /></td></tr>
<tr class="separator:ab1cf6c33a21ba788b1801f89e10e88dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45514ec38e38d1ae4194ee6e07c90917" id="r_a45514ec38e38d1ae4194ee6e07c90917"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#a45514ec38e38d1ae4194ee6e07c90917">correctedIrms</a> () const</td></tr>
<tr class="memdesc:a45514ec38e38d1ae4194ee6e07c90917"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the baseline-corrected RMS current.  <br /></td></tr>
<tr class="separator:a45514ec38e38d1ae4194ee6e07c90917"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a908e354d16c44c67d2be1b501e18bfc7" id="r_a908e354d16c44c67d2be1b501e18bfc7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#a908e354d16c44c67d2be1b501e18bfc7">setEnabled</a> (bool en)</td></tr>
<tr class="memdesc:a908e354d16c44c67d2be1b501e18bfc7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable or disable measurement updates.  <br /></td></tr>
<tr class="separator:a908e354d16c44c67d2be1b501e18bfc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfd4c88af45aa6f944e8f7d49b2ab04c" id="r_acfd4c88af45aa6f944e8f7d49b2ab04c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#acfd4c88af45aa6f944e8f7d49b2ab04c">isEnabled</a> () const</td></tr>
<tr class="memdesc:acfd4c88af45aa6f944e8f7d49b2ab04c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether the sensor is currently enabled.  <br /></td></tr>
<tr class="separator:acfd4c88af45aa6f944e8f7d49b2ab04c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a956b2d1ebc6c7199f13e94aeea0e13f0" id="r_a956b2d1ebc6c7199f13e94aeea0e13f0"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#a956b2d1ebc6c7199f13e94aeea0e13f0">pin_</a></td></tr>
<tr class="memdesc:a956b2d1ebc6c7199f13e94aeea0e13f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Analog input pin used for sensor reading.  <br /></td></tr>
<tr class="separator:a956b2d1ebc6c7199f13e94aeea0e13f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cc3180e6499a932093812698e5136bb" id="r_a0cc3180e6499a932093812698e5136bb"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#a0cc3180e6499a932093812698e5136bb">Vref_</a></td></tr>
<tr class="memdesc:a0cc3180e6499a932093812698e5136bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">ADC reference voltage in volts.  <br /></td></tr>
<tr class="separator:a0cc3180e6499a932093812698e5136bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fdc93e1b6faad78d4870528210ffc6d" id="r_a0fdc93e1b6faad78d4870528210ffc6d"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#a0fdc93e1b6faad78d4870528210ffc6d">adcMaxValue_</a></td></tr>
<tr class="memdesc:a0fdc93e1b6faad78d4870528210ffc6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum ADC reading (e.g. 1023.0 for 10-bit ADC).  <br /></td></tr>
<tr class="separator:a0fdc93e1b6faad78d4870528210ffc6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7306a34f2b028815bba590bf1b533a9b" id="r_a7306a34f2b028815bba590bf1b533a9b"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#a7306a34f2b028815bba590bf1b533a9b">k_cal_</a></td></tr>
<tr class="memdesc:a7306a34f2b028815bba590bf1b533a9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calibration factor converting RMS voltage to RMS current.  <br /></td></tr>
<tr class="separator:a7306a34f2b028815bba590bf1b533a9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8933ffbca9571bf7e1eb187fe375f94f" id="r_a8933ffbca9571bf7e1eb187fe375f94f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#a8933ffbca9571bf7e1eb187fe375f94f">enabled_</a> = false</td></tr>
<tr class="memdesc:a8933ffbca9571bf7e1eb187fe375f94f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag indicating whether measurements are currently enabled.  <br /></td></tr>
<tr class="separator:a8933ffbca9571bf7e1eb187fe375f94f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87e87f2b22a64174acc8411fb70cad52" id="r_a87e87f2b22a64174acc8411fb70cad52"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#a87e87f2b22a64174acc8411fb70cad52">sampleWindow_us_</a></td></tr>
<tr class="memdesc:a87e87f2b22a64174acc8411fb70cad52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integration window duration in microseconds.  <br /></td></tr>
<tr class="separator:a87e87f2b22a64174acc8411fb70cad52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1f999e84f5e1bb851386df8aaa04933" id="r_ac1f999e84f5e1bb851386df8aaa04933"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#ac1f999e84f5e1bb851386df8aaa04933">sampleInterval_us_</a></td></tr>
<tr class="memdesc:ac1f999e84f5e1bb851386df8aaa04933"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sampling interval in microseconds between ADC reads.  <br /></td></tr>
<tr class="separator:ac1f999e84f5e1bb851386df8aaa04933"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94683959898a97f8371b932bf8d743db" id="r_a94683959898a97f8371b932bf8d743db"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#a94683959898a97f8371b932bf8d743db">nextSampleTime_</a> = 0</td></tr>
<tr class="memdesc:a94683959898a97f8371b932bf8d743db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timestamp of the next scheduled ADC sample (in microseconds).  <br /></td></tr>
<tr class="separator:a94683959898a97f8371b932bf8d743db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9f63eb87a3cd2dc5fa09bb12688fad1" id="r_af9f63eb87a3cd2dc5fa09bb12688fad1"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#af9f63eb87a3cd2dc5fa09bb12688fad1">windowStart_</a> = 0</td></tr>
<tr class="memdesc:af9f63eb87a3cd2dc5fa09bb12688fad1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start timestamp of the current integration window (in microseconds).  <br /></td></tr>
<tr class="separator:af9f63eb87a3cd2dc5fa09bb12688fad1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63b07957a617d40cc299d8bef3149fd4" id="r_a63b07957a617d40cc299d8bef3149fd4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#a63b07957a617d40cc299d8bef3149fd4">adcMin_</a> = 1023</td></tr>
<tr class="memdesc:a63b07957a617d40cc299d8bef3149fd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimum ADC value observed in the current window.  <br /></td></tr>
<tr class="separator:a63b07957a617d40cc299d8bef3149fd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28bd9026e630c19a0fe71da267a337cc" id="r_a28bd9026e630c19a0fe71da267a337cc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#a28bd9026e630c19a0fe71da267a337cc">adcMax_</a> = 0</td></tr>
<tr class="memdesc:a28bd9026e630c19a0fe71da267a337cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum ADC value observed in the current window.  <br /></td></tr>
<tr class="separator:a28bd9026e630c19a0fe71da267a337cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53de01b186cd7bc6ae5086fb2675370f" id="r_a53de01b186cd7bc6ae5086fb2675370f"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#a53de01b186cd7bc6ae5086fb2675370f">Vpp_</a> = 0.0f</td></tr>
<tr class="memdesc:a53de01b186cd7bc6ae5086fb2675370f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Last computed peak-to-peak voltage in volts.  <br /></td></tr>
<tr class="separator:a53de01b186cd7bc6ae5086fb2675370f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb090717df3662b092fe39d969e597c5" id="r_aeb090717df3662b092fe39d969e597c5"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#aeb090717df3662b092fe39d969e597c5">Irms_</a> = 0.0f</td></tr>
<tr class="memdesc:aeb090717df3662b092fe39d969e597c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Last computed RMS current in amperes (uncorrected).  <br /></td></tr>
<tr class="separator:aeb090717df3662b092fe39d969e597c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a276040996b3ec7c97dad262e6311e594" id="r_a276040996b3ec7c97dad262e6311e594"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#a276040996b3ec7c97dad262e6311e594">sumV_</a> = 0.0f</td></tr>
<tr class="memdesc:a276040996b3ec7c97dad262e6311e594"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accumulator of voltage samples Σ v for RMS computation.  <br /></td></tr>
<tr class="separator:a276040996b3ec7c97dad262e6311e594"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dc1906c57b8c0757a92f1251e3bb633" id="r_a4dc1906c57b8c0757a92f1251e3bb633"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#a4dc1906c57b8c0757a92f1251e3bb633">sumV2_</a> = 0.0f</td></tr>
<tr class="memdesc:a4dc1906c57b8c0757a92f1251e3bb633"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accumulator of squared voltage samples Σ v^2 for RMS computation.  <br /></td></tr>
<tr class="separator:a4dc1906c57b8c0757a92f1251e3bb633"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3240edfe13071712f6b82765f2af7c2" id="r_ae3240edfe13071712f6b82765f2af7c2"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCurrentSensor.html#ae3240edfe13071712f6b82765f2af7c2">nSamples_</a> = 0</td></tr>
<tr class="memdesc:ae3240edfe13071712f6b82765f2af7c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of samples collected in the current window.  <br /></td></tr>
<tr class="separator:ae3240edfe13071712f6b82765f2af7c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Non-blocking RMS current measurement helper class. </p>
<p>The <a class="el" href="classCurrentSensor.html" title="Non-blocking RMS current measurement helper class.">CurrentSensor</a> class performs window-based RMS current measurement from an analog input pin connected to a current sensor (for example, a current transformer with burden resistor). It:</p><ul>
<li>periodically samples the ADC at a configured interval,</li>
<li>accumulates statistics (min, max, sum, sum of squares) over a time window,</li>
<li>computes both peak-to-peak voltage and true AC RMS current at the end of each window.</li>
</ul>
<p>The measurement is non-blocking: <a class="el" href="classCurrentSensor.html#aaa56cbbf919273ecad1ff8a158b92ec5" title="Perform one non-blocking update step of the measurement.">update()</a> should be called frequently in the main loop, and the computations are spread over time according to the sampling interval and window length. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="abefb5c33798e3e1c1dfc01c833512021" name="abefb5c33798e3e1c1dfc01c833512021"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abefb5c33798e3e1c1dfc01c833512021">&#9670;&#160;</a></span>CurrentSensor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CurrentSensor::CurrentSensor </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>analogPin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>Vref</em> = <code>5.0f</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>adcMaxValue</em> = <code>1023.0f</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>k_cal</em> = <code>0.90f</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>sampleWindow_us</em> = <code>20000UL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>sampleInterval_us</em> = <code>200UL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a new <a class="el" href="classCurrentSensor.html" title="Non-blocking RMS current measurement helper class.">CurrentSensor</a> object with configuration parameters. </p>
<p>Constructs a new <a class="el" href="classCurrentSensor.html" title="Non-blocking RMS current measurement helper class.">CurrentSensor</a> instance.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">analogPin</td><td>Analog input pin used to read the current sensor. </td></tr>
    <tr><td class="paramname">Vref</td><td>ADC reference voltage in volts (default 5.0 V). </td></tr>
    <tr><td class="paramname">adcMax</td><td>Maximum ADC reading (e.g. 1023.0 for 10-bit ADC). </td></tr>
    <tr><td class="paramname">k_cal</td><td>Calibration factor converting RMS voltage to RMS current (includes burden resistor and CT ratio). </td></tr>
    <tr><td class="paramname">sampleWindow_us</td><td>Duration of the RMS integration window in microseconds (default ~1 period at 50 Hz). </td></tr>
    <tr><td class="paramname">sampleInterval_us</td><td>Time between consecutive ADC samples in microseconds (default ~5 kHz sampling rate).</td></tr>
  </table>
  </dd>
</dl>
<p>The constructor only stores configuration parameters; it does not configure the hardware pin or reset internal statistics. Call <a class="el" href="classCurrentSensor.html#a9d8b040f89d8ea8a38ab4dfc25967a54" title="Initialize the sensor and reset internal statistics.">begin()</a> once before starting periodic measurements.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">analogPin</td><td>The analog input pin number used for current sensing. </td></tr>
    <tr><td class="paramname">Vref</td><td>The ADC reference voltage in volts. </td></tr>
    <tr><td class="paramname">adcMaxValue</td><td>The maximum ADC reading (e.g. 1023.0 for 10-bit ADC). </td></tr>
    <tr><td class="paramname">k_cal</td><td>Calibration factor to convert RMS voltage to RMS current. Typically this includes the burden resistor value and current transformer ratio. </td></tr>
    <tr><td class="paramname">sampleWindow_us</td><td>Duration of the RMS integration window in microseconds. </td></tr>
    <tr><td class="paramname">sampleInterval_us</td><td>Desired sampling interval in microseconds. The <a class="el" href="classCurrentSensor.html#aaa56cbbf919273ecad1ff8a158b92ec5" title="Perform one non-blocking update step of the measurement.">update()</a> method will attempt to sample at this rate based on micros(). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a9d8b040f89d8ea8a38ab4dfc25967a54" name="a9d8b040f89d8ea8a38ab4dfc25967a54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d8b040f89d8ea8a38ab4dfc25967a54">&#9670;&#160;</a></span>begin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CurrentSensor::begin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the sensor and reset internal statistics. </p>
<p>Initializes the sensor state and internal statistics.</p>
<p>This method should be called once (typically from setup()). It configures the pin mode for the analog input and resets timing and accumulated values used for RMS calculations.</p>
<p>This method must be called once (typically from setup()) before calling <a class="el" href="classCurrentSensor.html#aaa56cbbf919273ecad1ff8a158b92ec5" title="Perform one non-blocking update step of the measurement.">update()</a>. It configures the analog input pin, initializes the timing for the sampling window, and resets all statistics used for RMS calculations. </p>

</div>
</div>
<a id="a45514ec38e38d1ae4194ee6e07c90917" name="a45514ec38e38d1ae4194ee6e07c90917"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45514ec38e38d1ae4194ee6e07c90917">&#9670;&#160;</a></span>correctedIrms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float CurrentSensor::correctedIrms </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the baseline-corrected RMS current. </p>
<p>Returns the baseline-corrected RMS current.</p>
<p>The function subtracts the global baselineCurrent from the internally computed RMS current and clamps the result to zero if it would become negative. This is useful to eliminate sensor noise when no load is present.</p>
<dl class="section return"><dt>Returns</dt><dd>Baseline-corrected RMS current in amperes (non-negative).</dd></dl>
<p>This function subtracts a baseline offset current (baselineCurrent) from the internally computed RMS current (Irms_) and clamps the result to zero if the subtraction would produce a negative value. This is useful to compensate for sensor noise and offsets when no load is present.</p>
<dl class="section return"><dt>Returns</dt><dd>The corrected RMS current in amperes, guaranteed to be non-negative. </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCurrentSensor_a45514ec38e38d1ae4194ee6e07c90917_icgraph.png" border="0" usemap="#aclassCurrentSensor_a45514ec38e38d1ae4194ee6e07c90917_icgraph" alt=""/></div>
<map name="aclassCurrentSensor_a45514ec38e38d1ae4194ee6e07c90917_icgraph" id="aclassCurrentSensor_a45514ec38e38d1ae4194ee6e07c90917_icgraph">
<area shape="rect" title="Get the baseline&#45;corrected RMS current." alt="" coords="184,31,396,56"/>
<area shape="rect" href="classMod1Mode.html#aff19c0fd5e81f9f9cbd25e4efea6b9a4" title="Execute one step of the MOD1 state machine." alt="" coords="5,5,136,31"/>
<area shape="poly" title=" " alt="" coords="170,32,136,28,136,23,171,27"/>
<area shape="rect" href="classMod2Mode.html#a0f1d92665e2e76621d86460e6a6b67e1" title="Execute one step of the MOD2 state machine." alt="" coords="5,55,136,80"/>
<area shape="poly" title=" " alt="" coords="171,59,136,63,136,58,170,54"/>
</map>
</div>

</div>
</div>
<a id="acfd4c88af45aa6f944e8f7d49b2ab04c" name="acfd4c88af45aa6f944e8f7d49b2ab04c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfd4c88af45aa6f944e8f7d49b2ab04c">&#9670;&#160;</a></span>isEnabled()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CurrentSensor::isEnabled </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check whether the sensor is currently enabled. </p>
<dl class="section return"><dt>Returns</dt><dd>True if measurement updates are enabled, false otherwise. </dd></dl>

</div>
</div>
<a id="ab1cf6c33a21ba788b1801f89e10e88dd" name="ab1cf6c33a21ba788b1801f89e10e88dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1cf6c33a21ba788b1801f89e10e88dd">&#9670;&#160;</a></span>lastIrms()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float CurrentSensor::lastIrms </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the last computed RMS current. </p>
<p>This is the raw RMS current derived from the AC component of the measured voltage and scaled by the calibration factor k_cal. It does not include any baseline offset correction.</p>
<dl class="section return"><dt>Returns</dt><dd>Last computed RMS current in amperes. </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCurrentSensor_ab1cf6c33a21ba788b1801f89e10e88dd_icgraph.png" border="0" usemap="#aclassCurrentSensor_ab1cf6c33a21ba788b1801f89e10e88dd_icgraph" alt=""/></div>
<map name="aclassCurrentSensor_ab1cf6c33a21ba788b1801f89e10e88dd_icgraph" id="aclassCurrentSensor_ab1cf6c33a21ba788b1801f89e10e88dd_icgraph">
<area shape="rect" title="Get the last computed RMS current." alt="" coords="187,5,361,31"/>
<area shape="rect" href="classHomeMode.html#a6f709c817816acbc6a1e2e8f2cba30c1" title="Execute one non&#45;blocking step of the HOME mode state machine." alt="" coords="5,5,139,31"/>
<area shape="poly" title=" " alt="" coords="173,21,139,21,139,15,173,15"/>
</map>
</div>

</div>
</div>
<a id="aa5c066aa3ebd36107f9b94fb17a00ae1" name="aa5c066aa3ebd36107f9b94fb17a00ae1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5c066aa3ebd36107f9b94fb17a00ae1">&#9670;&#160;</a></span>lastVpp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float CurrentSensor::lastVpp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the last computed peak-to-peak voltage. </p>
<p>This value corresponds to the peak-to-peak voltage of the sensor signal over the most recently completed integration window.</p>
<dl class="section return"><dt>Returns</dt><dd>Last computed peak-to-peak voltage in volts. </dd></dl>

</div>
</div>
<a id="a908e354d16c44c67d2be1b501e18bfc7" name="a908e354d16c44c67d2be1b501e18bfc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a908e354d16c44c67d2be1b501e18bfc7">&#9670;&#160;</a></span>setEnabled()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CurrentSensor::setEnabled </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>en</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enable or disable measurement updates. </p>
<p>When disabled, calls to <a class="el" href="classCurrentSensor.html#aaa56cbbf919273ecad1ff8a158b92ec5" title="Perform one non-blocking update step of the measurement.">update()</a> do nothing and the last computed Irms and Vpp values are preserved.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">en</td><td>True to enable measurements, false to disable them. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCurrentSensor_a908e354d16c44c67d2be1b501e18bfc7_icgraph.png" border="0" usemap="#aclassCurrentSensor_a908e354d16c44c67d2be1b501e18bfc7_icgraph" alt=""/></div>
<map name="aclassCurrentSensor_a908e354d16c44c67d2be1b501e18bfc7_icgraph" id="aclassCurrentSensor_a908e354d16c44c67d2be1b501e18bfc7_icgraph">
<area shape="rect" title="Enable or disable measurement updates." alt="" coords="192,153,387,179"/>
<area shape="rect" href="classMod1Mode.html#aca5d7fc6351f06fb181fa358024138a8" title="Initialize MOD1 mode." alt="" coords="5,5,144,31"/>
<area shape="poly" title=" " alt="" coords="265,145,212,95,178,68,143,44,119,33,121,28,145,40,182,64,215,91,269,141"/>
<area shape="rect" href="classMod2Mode.html#a0fb9e060e1716ae9c15d25667c09c1e5" title="Initialize MOD2 mode." alt="" coords="5,55,144,80"/>
<area shape="poly" title=" " alt="" coords="253,149,143,94,114,83,116,78,145,89,255,144"/>
<area shape="rect" href="classMod1Mode.html#a8afb69c5a4ddc402cc7b8c7b9337087b" title="Cleanup performed when leaving MOD1 mode." alt="" coords="11,104,138,129"/>
<area shape="poly" title=" " alt="" coords="219,153,130,132,131,127,221,148"/>
<area shape="rect" href="classMod2Mode.html#a0fa0d62e0279bc87e128dddf7508da57" title="Cleanup performed when leaving MOD2 mode." alt="" coords="11,153,138,179"/>
<area shape="poly" title=" " alt="" coords="178,169,138,169,138,163,178,163"/>
<area shape="rect" href="classHomeMode.html#a6f709c817816acbc6a1e2e8f2cba30c1" title="Execute one non&#45;blocking step of the HOME mode state machine." alt="" coords="8,203,141,228"/>
<area shape="poly" title=" " alt="" coords="221,184,131,205,130,200,219,179"/>
<area shape="rect" href="classMod1Mode.html#aff19c0fd5e81f9f9cbd25e4efea6b9a4" title="Execute one step of the MOD1 state machine." alt="" coords="9,252,140,277"/>
<area shape="poly" title=" " alt="" coords="254,188,145,242,114,254,112,249,143,237,252,183"/>
<area shape="rect" href="classMod2Mode.html#a0f1d92665e2e76621d86460e6a6b67e1" title="Execute one step of the MOD2 state machine." alt="" coords="9,301,140,327"/>
<area shape="poly" title=" " alt="" coords="268,190,215,240,181,267,145,291,118,304,116,299,143,286,178,263,212,236,265,187"/>
</map>
</div>

</div>
</div>
<a id="aaa56cbbf919273ecad1ff8a158b92ec5" name="aaa56cbbf919273ecad1ff8a158b92ec5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa56cbbf919273ecad1ff8a158b92ec5">&#9670;&#160;</a></span>update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CurrentSensor::update </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform one non-blocking update step of the measurement. </p>
<p>Performs one non-blocking update step of the RMS measurement.</p>
<p>This function should be called frequently from the main loop. It:</p><ul>
<li>takes a new ADC sample when the sampling interval has elapsed,</li>
<li>updates min/max and RMS statistics for the current window,</li>
<li>computes Irms and Vpp at the end of each completed window.</li>
</ul>
<p>If the sensor is disabled via setEnabled(false), this function returns immediately and does not update the last computed measurements.</p>
<p>This function should be called frequently from the main loop. It:</p><ul>
<li>takes a new ADC sample when the sampling interval has elapsed,</li>
<li>accumulates statistics (min, max, sum, sum of squares),</li>
<li>closes and advances the integration window when the window duration expires,</li>
<li>computes the AC RMS current (Irms_) at the end of each window.</li>
</ul>
<p>Behavior details:</p><ul>
<li>If the sensor is disabled (enabled_ == false), the function returns immediately and does not modify the last computed Irms_ value.</li>
<li>Sampling is driven by micros() and integer arithmetic to be robust against micros() overflow.</li>
<li>The AC RMS is computed as sqrt( &lt;v^2&gt; - &lt;v&gt;^2 ), i.e. the RMS of the AC component after removing DC offset, and then scaled by k_cal_. </li>
</ul>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a28bd9026e630c19a0fe71da267a337cc" name="a28bd9026e630c19a0fe71da267a337cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28bd9026e630c19a0fe71da267a337cc">&#9670;&#160;</a></span>adcMax_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int CurrentSensor::adcMax_ = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Maximum ADC value observed in the current window. </p>

</div>
</div>
<a id="a0fdc93e1b6faad78d4870528210ffc6d" name="a0fdc93e1b6faad78d4870528210ffc6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fdc93e1b6faad78d4870528210ffc6d">&#9670;&#160;</a></span>adcMaxValue_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float CurrentSensor::adcMaxValue_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Maximum ADC reading (e.g. 1023.0 for 10-bit ADC). </p>

</div>
</div>
<a id="a63b07957a617d40cc299d8bef3149fd4" name="a63b07957a617d40cc299d8bef3149fd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63b07957a617d40cc299d8bef3149fd4">&#9670;&#160;</a></span>adcMin_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int CurrentSensor::adcMin_ = 1023</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Minimum ADC value observed in the current window. </p>

</div>
</div>
<a id="a8933ffbca9571bf7e1eb187fe375f94f" name="a8933ffbca9571bf7e1eb187fe375f94f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8933ffbca9571bf7e1eb187fe375f94f">&#9670;&#160;</a></span>enabled_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CurrentSensor::enabled_ = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flag indicating whether measurements are currently enabled. </p>

</div>
</div>
<a id="aeb090717df3662b092fe39d969e597c5" name="aeb090717df3662b092fe39d969e597c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb090717df3662b092fe39d969e597c5">&#9670;&#160;</a></span>Irms_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float CurrentSensor::Irms_ = 0.0f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Last computed RMS current in amperes (uncorrected). </p>

</div>
</div>
<a id="a7306a34f2b028815bba590bf1b533a9b" name="a7306a34f2b028815bba590bf1b533a9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7306a34f2b028815bba590bf1b533a9b">&#9670;&#160;</a></span>k_cal_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float CurrentSensor::k_cal_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calibration factor converting RMS voltage to RMS current. </p>

</div>
</div>
<a id="a94683959898a97f8371b932bf8d743db" name="a94683959898a97f8371b932bf8d743db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94683959898a97f8371b932bf8d743db">&#9670;&#160;</a></span>nextSampleTime_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long CurrentSensor::nextSampleTime_ = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Timestamp of the next scheduled ADC sample (in microseconds). </p>

</div>
</div>
<a id="ae3240edfe13071712f6b82765f2af7c2" name="ae3240edfe13071712f6b82765f2af7c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3240edfe13071712f6b82765f2af7c2">&#9670;&#160;</a></span>nSamples_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t CurrentSensor::nSamples_ = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of samples collected in the current window. </p>

</div>
</div>
<a id="a956b2d1ebc6c7199f13e94aeea0e13f0" name="a956b2d1ebc6c7199f13e94aeea0e13f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a956b2d1ebc6c7199f13e94aeea0e13f0">&#9670;&#160;</a></span>pin_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t CurrentSensor::pin_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Analog input pin used for sensor reading. </p>

</div>
</div>
<a id="ac1f999e84f5e1bb851386df8aaa04933" name="ac1f999e84f5e1bb851386df8aaa04933"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1f999e84f5e1bb851386df8aaa04933">&#9670;&#160;</a></span>sampleInterval_us_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long CurrentSensor::sampleInterval_us_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sampling interval in microseconds between ADC reads. </p>

</div>
</div>
<a id="a87e87f2b22a64174acc8411fb70cad52" name="a87e87f2b22a64174acc8411fb70cad52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87e87f2b22a64174acc8411fb70cad52">&#9670;&#160;</a></span>sampleWindow_us_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long CurrentSensor::sampleWindow_us_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Integration window duration in microseconds. </p>

</div>
</div>
<a id="a4dc1906c57b8c0757a92f1251e3bb633" name="a4dc1906c57b8c0757a92f1251e3bb633"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4dc1906c57b8c0757a92f1251e3bb633">&#9670;&#160;</a></span>sumV2_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float CurrentSensor::sumV2_ = 0.0f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Accumulator of squared voltage samples Σ v^2 for RMS computation. </p>

</div>
</div>
<a id="a276040996b3ec7c97dad262e6311e594" name="a276040996b3ec7c97dad262e6311e594"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a276040996b3ec7c97dad262e6311e594">&#9670;&#160;</a></span>sumV_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float CurrentSensor::sumV_ = 0.0f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Accumulator of voltage samples Σ v for RMS computation. </p>
<p>Used together with sumV2_ and nSamples_ to derive the mean and variance of the measured signal within a window, allowing computation of the AC RMS voltage after removing the DC offset. </p>

</div>
</div>
<a id="a53de01b186cd7bc6ae5086fb2675370f" name="a53de01b186cd7bc6ae5086fb2675370f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53de01b186cd7bc6ae5086fb2675370f">&#9670;&#160;</a></span>Vpp_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float CurrentSensor::Vpp_ = 0.0f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Last computed peak-to-peak voltage in volts. </p>

</div>
</div>
<a id="a0cc3180e6499a932093812698e5136bb" name="a0cc3180e6499a932093812698e5136bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cc3180e6499a932093812698e5136bb">&#9670;&#160;</a></span>Vref_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float CurrentSensor::Vref_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>ADC reference voltage in volts. </p>

</div>
</div>
<a id="af9f63eb87a3cd2dc5fa09bb12688fad1" name="af9f63eb87a3cd2dc5fa09bb12688fad1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9f63eb87a3cd2dc5fa09bb12688fad1">&#9670;&#160;</a></span>windowStart_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long CurrentSensor::windowStart_ = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Start timestamp of the current integration window (in microseconds). </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="CurrentSensor_8h_source.html">CurrentSensor.h</a></li>
<li><a class="el" href="CurrentSenros_8cpp.html">CurrentSenros.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
